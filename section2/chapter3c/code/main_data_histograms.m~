% this file loads the data and removes the initial missing data
load_data
% Defining random sample and creating the datasets with missing data
perc = [0.05, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60,0.70, 0.80, 0.90];
rng(163)
[IAC_M{1},IAC_M{2},IAC_M{3},~, IAC_M{4}, ~, ~, ~...
    , IAC_M{5}, ~]= create_missing_special(IAC,perc);
separate =1;
data_out = IAC_out;
methodindex = [1 2 3 4 6 7];
for i=methodindex
    i
    try
        for j=1:1:length(perc)% cycle for the different percentages of missingness
            rng(163+i)
            data_in = IAC_M{1,j};
            data_in_new{i,j}= data_inpute(method{i},data_in,data_out,separate,constraint);
        end
    catch
    end
end
save('DataForHistogramsIAC.mat','data_in_new','IAC_M')

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% this file loads the data and removes the initial missing data
load_data
% Defining random sample and creating the datasets with missing data
perc = [0.05, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60,0.70, 0.80, 0.90];
rng(163)
[NIAC_M{1},NIAC_M{2},NIAC_M{3},~, NIAC_M{4}, ~, ~, ~...
    , NIAC_M{5}, ~]= create_missing_special(NON_IAC,perc);
separate =1;
data_out = NON_IAC_out;
methodindex = [1 2 3 4 6 7];
for i=methodindex
    i
    try
        for j=1:1:length(perc)% cycle for the different percentages of missingness
            rng(163+i)
            data_in = NIAC_M{1,j};
            data_in_new{i,j}= data_inpute(method{i},data_in,data_out,separate,constraint);
        end
    catch
    end
end
save('DataForHistogramsNONIAC.mat','data_in_new','NIAC_M')


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%
%
%
%
%               UNIVARIATE
%
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% SELECT DATASET
dataset = 'IAC';
type = 'univar';
%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% this file loads the data and removes the initial missing data
separate =1;
load_data
method = {'remove','mean','median','linear','knn','randlinear','MI-Cond',...
'MI-MVN'};
switch dataset
    case 'IAC'
        Orig_2_save=DATA(find(alinecohortdatajune15.ALINE_FLG==1),:);
        out=alinecohortdatajune15(find(alinecohortdatajune15.ALINE_FLG==1),:);
        Orig_2_save = Orig_2_save(:,1:end-1);
    case 'NON_IAC'
        Orig_2_save=DATA(find(alinecohortdatajune15.ALINE_FLG==0),:);
        out=alinecohortdatajune15(find(alinecohortdatajune15.ALINE_FLG==0),:);        
        Orig_2_save = Orig_2_save(:,1:end-1);
    otherwise     
end
[Orig_2_save, out] = remove_missing(Orig_2_save,out);
column2remove=1;
% Defining random sample and creating the datasets with missing data
perc = [0.05, 0.10, 0.20, 0.40, 0.80];
rng(163)
[DATA_in_M,orig_data_in] = create_missingness_datasets(data_in,perc,column2remove,type);
switch type
    case 'univar'
        methodindex = [1 2 3 4 5 6 7 8];
 method = {'remove','mean','median','linear','knn','randlinear','MI-Cond',...
'MI-MVN'};       
    case 'multi'
        methodindex = [1 2 3 4 5 6 7]; 
        method = {'remove','mean','median','linear','knn','MI-Cond',...
'MI-MVN'};
    otherwise
        error('myApp:argChk1', 'WRONG type of missigness selected, please try: univar or multi')        
end
for i=methodindex(1:end-2)
    i
    try
        for j=1:1:5% cycle for the different percentages of missingness
            rng(163+i)
            data_in = DATA_in_M{1,j};
            data_in_new{i,j}= data_inpute(method{i},data_in,data_out,separate,constraint);
        end
    catch
    end
end

j=methodindex(end-1);
for i =1:1:5
    filename = strcat('Amelia','_',dataset,'_',type,'_perc',num2str(perc(i)*100),'_original.csv');
    data = readtable(filename);
    data_in_new{j,i} = data(:,4:29);
end
j=methodindex(end);
for i=1:1:5
    filename = strcat('MICE','_',dataset,'_',type,'_perc',num2str(perc(i)*100),'_original.csv');
    data = readtable(filename);
    data_in_new{j,i} = data(:,2:27);
end
ORIG_DATA =Orig_2_save;
saveFilename= strcat(type,'_','DataForHistograms',dataset,'.mat');
save(saveFilename,'data_in_new','DATA_in_M','ORIG_DATA','method')

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% this file loads the data and removes the initial missing data
load_data
NON_IACtosave=DATA(find(alinecohortdatajune15.ALINE_FLG==0),:);
NON_IACtosave = NON_IACtosave(:,1:end-1);
column2remove=1;
% Defining random sample and creating the datasets with missing data
perc = [0.05, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60,0.70, 0.80, 0.90];
rng(163)
[NIAC_M{1},NIAC_M{2},NIAC_M{3},~, NIAC_M{4}, ~, ~, ~...
    , NIAC_M{5}, ~]= create_missing_special_univariate(NON_IAC,perc,column2remove);
NIAC =IAC(:,1:end-1);
NIAC_M{1}=NIAC_M{1}(:,1:end-1);
NIAC_M{2}=NIAC_M{2}(:,1:end-1);
NIAC_M{3}=NIAC_M{3}(:,1:end-1);
NIAC_M{4}=NIAC_M{4}(:,1:end-1);
NIAC_M{5}=NIAC_M{5}(:,1:end-1);
separate =1;
data_out = NON_IAC_out;
methodindex = [1 2 3 4 6 7 8 9];
for i=methodindex
    i
    try
        for j=1:1:5% cycle for the different percentages of missingness
            rng(163+i)
            data_in = NIAC_M{1,j};
            data_in_new{i,j}= data_inpute(method{i},data_in,data_out,separate,constraint);
        end
    catch
    end
end
method{10} ='MICE';
method{11} ='Amelia';
percstr = {'5','10','20','40','80'};
j=10;
for i =1:1:5
    filename = strcat(method{j},'_univar_NON_IAC_Imb',percstr{i},'_original.csv');
    data = readtable(filename);
    data_in_new{j,i} = data(:,4:29);
end
j=11;
for i=1:1:5
    filename = strcat(method{j},'_univar_NON_IAC_Imb',percstr{i},'_original.csv');
    data = readtable(filename);
    data_in_new{j,i} = data(:,2:27);
end
NON_IAC =NON_IACtosave;
save('univar_DataForHistogramsNONIAC.mat','data_in_new','NIAC_M','NON_IAC','method')